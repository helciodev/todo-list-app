(()=>{const t=document.getElementById("list-container"),e="task.lists";let n=JSON.parse(localStorage.getItem(e))||[];const d=document.getElementById("list-input"),a=document.querySelector("[data-list-new]"),o=document.getElementById("list-title"),l=document.getElementById("tasks"),s=document.getElementById("tasks-list"),i=document.getElementById("add-task"),c=document.getElementById("task-input"),r=(document.getElementById("task-input-modal"),document.getElementById("date-modal"),document.getElementById("option-modal"),document.getElementById("description-modal"),document.getElementById("save-btn-modal"),document.getElementById("task-render")),m=document.getElementById("date"),u=document.getElementById("option"),g=document.getElementById("description"),p=document.getElementById("task-count");let y=n[n.length-1]||"";const E=document.getElementById("modal-parent");function I(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function k(){localStorage.setItem(e,JSON.stringify(n)),localStorage.setItem("selected.list",JSON.stringify(y))}function f(){I(t),n.forEach((e=>{const n=document.createElement("li");n.setAttribute("class","text-2xl cursor-pointer my-2 text-gray-100 uppercase"),n.dataset.listId=e.id,n.textContent=e.name,n.insertAdjacentHTML("beforeend",`\n    <i data-element = ${e.id} class="fa cursor-pointer fa-times-circle" aria-hidden="true"></i>`),t.appendChild(n)}))}function x(){I(s),y.tasks.forEach(((t,e)=>{const n=document.importNode(r.content,!0);n.querySelector("#task-title").textContent=t.name,n.getElementById("due-date-display").textContent=t.dueDate;const d=n.getElementById("priority-display");var a;d.textContent=t.priority,"low"===(a=d).textContent?a.classList.add("text-gray-500","font-bold"):"medium"===a.textContent?a.classList.add("text-yellow-500","font-bold"):a.classList.add("text-red-500","font-bold"),n.querySelector("#description-para").textContent=t.description;const o=n.querySelector("input");o.classList.add("checked"),o.checked=t.complete,[o,n.getElementById("edit"),n.getElementById("delete")].forEach((t=>{t.dataset.taskIndex=e})),s.appendChild(n)}))}function B(){const t=y.tasks.filter((t=>1==!t.complete)).length;return 1===t?`${t} task remaining`:`${t} tasks remaining`}function v(){k(),f()}l.classList.remove(".hidden"),console.log(B()),t.addEventListener("click",(t=>{y=n.find((e=>e.id===t.target.dataset.listId)),k(),"li"===t.target.tagName.toLowerCase()&&(l.classList.remove("hidden"),o.textContent=t.target.textContent,p.textContent=B()),x()})),a.addEventListener("submit",(t=>{t.preventDefault();const e=d.value;if(null===e||""===e)return;const a=(o=e,{id:Date.now().toString(),name:o,tasks:[]});var o;d.value="",n.push(a),v()})),i.addEventListener("click",(()=>{const t=c.value,e=m.value,n=g.value,d=u.value;if(null===t||""===t)return;const a=function(t,e,n,d){return{id:Date.now().toString(),name:t,complete:!1,description:d,dueDate:n,priority:e}}(t,d,e,n);c.value="",g.value="",m.value=null,y.tasks.push(a),k(),x(),p.textContent=B()})),t.addEventListener("click",(t=>{n=n.filter((e=>e.id!==t.target.dataset.element)),v()})),window.addEventListener("click",(t=>{"delete"===t.target.id?(y.tasks.splice(t.target.dataset.listId,1),k(),x()):"checkbox"===t.target.id?(t.target.checked?y.tasks[t.target.dataset.taskIndex].complete=!0:y.tasks[t.target.dataset.taskIndex].complete=!1,k(),f(),x(),p.textContent=B()):"edit"!==t.target.id&&"close-btn"!==t.target.id||E.classList.toggle("center")})),localStorage&&f()})();